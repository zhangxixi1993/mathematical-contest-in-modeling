%-----------使用UI模型建立PI模型，得到一系列PI曲线---------
clc
clear all
close all
data=xlsread('data.xlsx');
p=data(:,2);%光功率
i=data(:,1);%驱动电流
u=data(:,3);%电压
t0=data(:,4);%环境温度
plot(i,p,'--blue')
hold on
%10摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(283.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(283.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(283.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(283.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
set(h,'Linestyle','-','color','c','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on
hold on

%20摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(293.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(293.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(293.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(293.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
set(h,'Linestyle','-','color','r','Linewidth',1);%设置第一条曲线的线型、颜色、粗细
grid on
hold on

%30摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(303.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(303.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(303.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(303.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
set(h,'Linestyle','-','color','k','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on
hold on

%40摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(313.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(313.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(313.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(313.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
hold on;
set(h,'Linestyle','-','color','y','Linewidth',2);%设置第一条曲线的线型、颜色、粗细

%50摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(323.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(323.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(323.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(323.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
set(h,'Linestyle','-','color','b','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on
hold on

%60摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(333.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(333.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(333.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(333.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
hold on
set(h,'Linestyle','-','color','g','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on

%70摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(343.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(343.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(343.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(343.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
hold on
set(h,'Linestyle','-','color','m','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on

%80摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(353.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(353.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(353.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(353.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
hold on
set(h,'Linestyle','-','color','c','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on

%90摄氏度
h=ezplot('0.2884*(I-4.1808-3.1208-0.0624*(363.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)+4.0756e-4*(363.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^2+4.1335e-7*(363.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^3-2.7308e-9*(363.15+(I.*(0.0579*I+0.15*log(1+1.03e5*I))-P)*2.1035)^4)-P',[0,14],[0 3]);
hold on
set(h,'Linestyle','--','color','c','Linewidth',2);%设置第一条曲线的线型、颜色、粗细
grid on
%% 

title('优化模型的P-I曲线')
xlabel('驱动电流I/mA')
ylabel('光功率P/mW')
legend('20度原曲线','10度模型','20度模型','30度模型','40度模型','50度模型','60度模型','70度模型')

